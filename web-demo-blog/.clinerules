# .clinerules — AI 코드 생성 변경 관리 가이드 (Cline용)

## 핵심 규칙

당신은 이 프로젝트에서 코드를 생성·수정할 때 다음 규칙을 반드시 따라야 합니다.
이 규칙은 AI 코드 생성의 비결정성(같은 스펙으로도 다른 코드가 나오는 문제)을 방지하고,
스펙과 코드 간의 형상 일관성을 유지하기 위한 것입니다.

---

## 1. 절대 재생성 금지

- 기존에 존재하는 코드 파일을 전체 재생성(삭제 후 새로 작성)하지 마세요.
- 변경이 필요하면 기존 코드를 읽고, 해당 부분만 증분 수정하세요.
- "처음부터 다시 작성할게요"라는 접근은 금지입니다.

## 2. 기존 패턴 우선

- 새 코드를 작성하기 전에 반드시 같은 디렉토리 또는 같은 레이어의 기존 파일을 확인하세요.
- 기존 파일의 구조, 네이밍, 패턴, import 방식을 그대로 따르세요.
- 프로젝트에 없는 새로운 라이브러리나 패턴을 임의로 도입하지 마세요.

## 3. 변경 추적성 확보

- 모든 변경 시 관련 요구사항 번호(REQ-XXXX)를 주석으로 남기세요.
- 형식: `// [REQ-XXXX] 변경 설명 (날짜)`
- 커밋 메시지 제안 시에도 스펙 ID를 포함하세요.

## 4. 작은 단위로 작업

- 한 번에 하나의 함수, 하나의 클래스만 생성 또는 수정하세요.
- 전체 모듈을 한 번에 생성하지 마세요.
- 여러 파일을 수정해야 하는 경우, 파일 하나씩 순서대로 처리하세요.

## 5. 변경 영향도 분석 먼저

스펙 변경 요청을 받으면 바로 코드를 수정하지 말고, 먼저 다음을 수행하세요:
1. 변경 영향을 받는 파일 목록을 나열
2. 각 파일에서 수정이 필요한 부분을 설명
3. 사용자 확인 후 수정 진행

---

## 코드 컨벤션

> 아래 항목을 프로젝트에 맞게 수정하세요.

### 언어/프레임워크
- 언어: [Java 17 / TypeScript / Python 등]
- 프레임워크: [Spring Boot 3.x / Next.js / FastAPI 등]

### 네이밍
- 클래스: PascalCase
- 메서드/함수: camelCase
- 상수: UPPER_SNAKE_CASE

### 레이어 구조
- Controller → Service (Interface + Impl) → Repository
- DTO와 Entity 분리
- 예외: 커스텀 BusinessException 사용
- 응답: 공통 ApiResponse<T> 래퍼 사용

### 디렉토리 구조
```
src/
├── controller/
├── service/
│   └── impl/
├── repository/
├── domain/
├── dto/
├── config/
├── exception/
└── common/
```

---

## 변경 작업 워크플로우

### 스펙 변경 시
1. 영향 범위 파악 → 영향받는 파일 목록 출력
2. 기존 코드 확인 → 현재 구현 상태 파악
3. 증분 수정 수행 → 변경 필요한 부분만 수정
4. 일관성 검증 → 관련 파일과의 정합성 확인
5. 커밋 메시지 제안 → `[REQ-XXXX] 변경 내용 요약`

### 신규 기능 개발 시
1. 기존 레퍼런스 파일 확인
2. 동일 패턴으로 코드 생성
3. 파일 단위로 하나씩 생성
4. 인터페이스 일치 확인

---

## 금지 사항

- ❌ 파일 전체 재생성 (삭제 후 새로 작성)
- ❌ 기존 패턴과 다른 방식의 구현
- ❌ 프로젝트에 없는 라이브러리/패턴 임의 도입
- ❌ 한 번에 3개 이상 파일 대규모 변경
- ❌ 스펙 ID 없는 코드 변경
- ❌ 영향도 분석 없이 바로 코드 수정

---

## 역방향 산출물 생성

코드 → 설계서 역방향 생성이 필요하면 다음을 요청받을 수 있습니다:
- 클래스 다이어그램
- 시퀀스 다이어그램
- 인터페이스 명세
- 비즈니스 로직 설명

이 경우 최종 코드의 실제 구현을 기반으로 정확한 산출물을 작성하세요.

---

## Memory Bank 연동 (선택)

Cline의 Memory Bank 기능을 사용하는 경우, 다음 파일들을 유지하세요:

### projectbrief.md
프로젝트 개요, 목표, 주요 요구사항을 기록합니다.

### activeContext.md
현재 작업 중인 스펙 변경 사항과 진행 상태를 기록합니다.
```markdown
## 현재 진행 중인 변경

### [REQ-XXXX] 변경 제목
- 상태: 진행중 / 완료
- 영향 파일: file1.java, file2.java
- 변경 내용: ...
- 완료일: YYYY-MM-DD
```

### changelog.md
모든 스펙 변경 이력을 누적 기록합니다.
```markdown
## 변경 이력

| 날짜 | 스펙 ID | 변경 내용 | 영향 파일 | 상태 |
|------|---------|----------|----------|------|
| 2025-03-15 | REQ-0042 | 구구단 0단 제외 | Gugudan.java | 완료 |
```
